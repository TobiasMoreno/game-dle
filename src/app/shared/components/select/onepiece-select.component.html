<div class="relative w-full">
  <button type="button"
    class="w-full flex items-center justify-between px-4 py-2 border-4 border-yellow-700 bg-yellow-200 rounded-xl shadow pirate-font text-lg focus:outline-none focus:ring-2 focus:ring-blue-400 transition"
    [class.opacity-60]="disabled"
    [disabled]="disabled"
    (click)="toggleDropdown()"
    (blur)="onBlur()"
  >
    <span *ngIf="selected !== null; else placeholderTpl">
      <ng-container *ngIf="showIcons && getIcon(selectedOption)">
        <img [src]="getIcon(selectedOption)" alt="icon" class="inline w-6 h-6 mr-2 align-middle" />
      </ng-container>
      {{ getLabel(selectedOption) }}
    </span>
    <ng-template #placeholderTpl>
      <span class="text-gray-500">{{ placeholder }}</span>
    </ng-template>
    <span class="ml-2 pirate-font">▼</span>
    <span *ngIf="selected !== null" (click)="clearSelection($event)" class="ml-2 text-red-600 hover:text-red-800 cursor-pointer pirate-font">✕</span>
  </button>
  <div *ngIf="isOpen" class="absolute z-30 mt-2 w-full bg-yellow-100 border-4 border-yellow-700 rounded-xl shadow-xl max-h-60 overflow-auto {{dropdownClass}}">
    <input type="text" [(ngModel)]="search" (input)="onInput($event)" placeholder="Buscar..." class="w-full px-3 py-2 mb-2 border-b-2 border-yellow-700 bg-yellow-50 rounded-t-xl pirate-font focus:outline-none" autocomplete="off" />
    <ul>
      <li *ngFor="let option of filteredOptions"
          (click)="selectOption(option)"
          class="px-4 py-2 cursor-pointer hover:bg-yellow-300 flex items-center pirate-font text-base {{optionClass}}"
      >
        <ng-container *ngIf="showIcons && getIcon(option)">
          <img [src]="getIcon(option)" alt="icon" class="inline w-6 h-6 mr-2 align-middle" />
        </ng-container>
        {{ getLabel(option) }}
      </li>
      <li *ngIf="filteredOptions.length === 0" class="px-4 py-2 text-gray-500 pirate-font">Sin resultados</li>
    </ul>
  </div>
</div> 